@import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700;800&family=IBM+Plex+Mono:wght@400;500;600&display=swap');
:root {
  --bg:#08090d;--bg2:#0f1118;--bg3:#141620;--bg4:#191c2a;
  --bdr:#1f2335;--bdr2:#2a2f45;
  --tx:#c9cdd8;--txd:#5c6178;--txb:#eef0f6;
  --blue:#4f8ff7;--blueg:rgba(79,143,247,0.12);
  --green:#34d399;--greeng:rgba(52,211,153,0.12);
  --amber:#fbbf24;--amberg:rgba(251,191,36,0.12);
  --rose:#fb7185;--roseg:rgba(251,113,133,0.12);
  --purple:#a78bfa;--purpleg:rgba(167,139,250,0.12);
  --cyan:#22d3ee;--cyang:rgba(34,211,238,0.12);
  --orange:#fb923c;--orangeg:rgba(251,146,60,0.12);
  --mono:'IBM Plex Mono',monospace;--sans:'DM Sans',sans-serif;
  --radius:12px;
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--tx);font-family:var(--sans);line-height:1.65;-webkit-font-smoothing:antialiased}

/* Layout */
.root{max-width:1200px;margin:0 auto;padding:40px 24px 100px}

/* Hero */
.hero{text-align:center;padding:56px 0 40px;position:relative}
.hero::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:80%;max-width:600px;height:1px;background:linear-gradient(90deg,transparent,var(--bdr2),transparent)}
.hero h1{font-size:2.2rem;font-weight:800;color:var(--txb);letter-spacing:-0.04em;margin-bottom:10px}
.hero h1 .g{color:var(--green)} .hero h1 .b{color:var(--blue)}
.hero .sub{color:var(--txd);font-size:0.9rem;max-width:640px;margin:0 auto;line-height:1.7}

/* Tabs */
.tabs{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-bottom:40px;position:sticky;top:0;z-index:100;background:linear-gradient(var(--bg) 60%,transparent);padding:16px 0 20px;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px)}
.tab{background:var(--bg3);border:1px solid var(--bdr);color:var(--txd);padding:8px 16px;border-radius:8px;cursor:pointer;font-family:var(--sans);font-size:0.76rem;font-weight:600;transition:all 0.2s;white-space:nowrap}
.tab:hover{border-color:var(--bdr2);color:var(--tx);background:var(--bg4)}
.tab.active{background:var(--blueg);border-color:var(--blue);color:var(--blue);box-shadow:0 0 12px rgba(79,143,247,0.15)}
.tab .tn{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:50%;background:rgba(255,255,255,0.05);font-size:0.6rem;margin-right:6px;font-weight:700}
.tab.active .tn{background:var(--blue);color:#fff}

/* Sections */
#app .section{display:none;animation:fadeUp .35s ease} #app .section.vis{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

/* Section headers */
.sh{margin-top:8px;margin-bottom:28px;padding-bottom:20px;border-bottom:1px solid var(--bdr)}
.c + .sh{margin-top:32px}
.c + .g2,.c + .g3,.c + .g4{margin-top:32px}
.sh h2{font-size:1.4rem;font-weight:800;color:var(--txb);letter-spacing:-0.03em;margin-bottom:4px}
.sh .sd{color:var(--txd);font-size:0.85rem}
h3{font-size:1.05rem;font-weight:700;color:var(--txb);margin-bottom:10px;margin-top:6px}
h4{font-size:0.85rem;font-weight:700;color:var(--txb);margin-bottom:6px}
.badge{display:inline-block;padding:3px 10px;border-radius:6px;font-size:0.62rem;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;margin-bottom:8px;vertical-align:middle}

/* Grids */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:32px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-bottom:32px}
.g4{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:14px;margin-bottom:32px}
@media(max-width:900px){.g2,.g3,.g4{grid-template-columns:1fr}}
.fw{margin-bottom:28px}

/* Cards */
.c{background:var(--bg3);border:1px solid var(--bdr);border-radius:var(--radius);padding:22px;transition:border-color 0.25s,box-shadow 0.25s}
.c:hover{border-color:var(--bdr2);box-shadow:0 2px 20px rgba(0,0,0,0.15)}
.c h3{font-size:0.85rem;font-weight:700;color:var(--txb);margin-bottom:10px;margin-top:0;display:flex;align-items:center;gap:7px}
.c p,.c li{font-size:0.8rem;color:var(--tx);line-height:1.7}
.c ul{list-style:none;padding:0} .c li{padding-left:16px;position:relative;margin-bottom:4px}
.c li::before{content:'â†’';position:absolute;left:0;color:var(--blue);font-weight:600;font-size:0.72rem}
.c ol{padding-left:20px} .c ol li{padding-left:4px} .c ol li::before{display:none}
.c-blue{border-left:3px solid var(--blue)} .c-green{border-left:3px solid var(--green)}
.c-amber{border-left:3px solid var(--amber)} .c-rose{border-left:3px solid var(--rose)}
.c-purple{border-left:3px solid var(--purple)} .c-cyan{border-left:3px solid var(--cyan)}
.c-orange{border-left:3px solid var(--orange)}

/* Inline code */
code{font-family:var(--mono);font-size:0.75em;background:rgba(255,255,255,0.06);padding:2px 6px;border-radius:4px;color:var(--cyan)}

/* Code blocks */
.code{font-family:var(--mono);font-size:0.7rem;background:rgba(0,0,0,0.4);border:1px solid var(--bdr);border-radius:10px;padding:16px 18px;line-height:1.85;overflow-x:auto;color:var(--txd);margin-top:10px}
.code .kw{color:var(--purple)} .code .fn{color:var(--cyan)} .code .str{color:var(--green)}
.code .cm{color:#3d4259} .code .hl{color:var(--amber);font-weight:600}
.code .tp{color:var(--blue)} .code .num{color:var(--orange)}

/* Tables */
.tbl{width:100%;border-collapse:collapse;font-size:0.72rem;margin-top:10px}
.tbl th{text-align:left;padding:9px 12px;background:var(--bg4);color:var(--txd);font-weight:600;text-transform:uppercase;letter-spacing:0.06em;font-size:0.63rem;border-bottom:2px solid var(--bdr2)}
.tbl td{padding:8px 12px;border-bottom:1px solid rgba(31,35,53,0.5);color:var(--tx);font-family:var(--mono);font-size:0.68rem}
.tbl td:first-child{color:var(--txb);font-weight:500} .tbl td:nth-child(2){color:var(--blue)}
.tbl tr:hover td{background:rgba(79,143,247,0.04)}
.tbl tbody tr:last-child td{border-bottom:none}

/* Flow timeline */
.flow{display:flex;align-items:stretch;gap:0;margin:16px 0;flex-wrap:wrap}
.fs{flex:1;min-width:130px;padding:14px;background:var(--bg3);border:1px solid var(--bdr);display:flex;flex-direction:column;gap:5px}
.fs:first-child{border-radius:10px 0 0 10px} .fs:last-child{border-radius:0 10px 10px 0}
.fs .n{font-family:var(--mono);font-size:0.58rem;color:var(--txd);font-weight:700}
.fs .t{font-size:0.76rem;font-weight:700;color:var(--txb)}
.fs .d{font-size:0.66rem;color:var(--txd);line-height:1.5}
.fs .tech{font-family:var(--mono);font-size:0.58rem;color:var(--blue);margin-top:auto;padding-top:5px}
.fa{display:flex;align-items:center;justify-content:center;color:var(--blue);font-size:1rem;padding:0 2px;flex-shrink:0}

/* Callouts */
.callout{padding:16px 20px;border-radius:10px;margin:18px 0;font-size:0.78rem;line-height:1.7}
.callout strong{color:inherit}
.co-blue{background:var(--blueg);border:1px solid rgba(79,143,247,0.2);color:#6ea4ff}
.co-amber{background:var(--amberg);border:1px solid rgba(251,191,36,0.2);color:var(--amber)}
.co-green{background:var(--greeng);border:1px solid rgba(52,211,153,0.2);color:var(--green)}
.co-rose{background:var(--roseg);border:1px solid rgba(251,113,133,0.2);color:var(--rose)}

/* Algorithm boxes */
.algo{background:var(--bg4);border:1px solid var(--bdr2);border-radius:var(--radius);padding:20px;margin:16px 0}
.algo h4{font-size:0.76rem;font-weight:700;color:var(--amber);margin-bottom:8px;display:flex;align-items:center;gap:6px}
.algo p{font-size:0.76rem;color:var(--tx);line-height:1.7}

/* Separators */
.sep{height:1px;background:linear-gradient(90deg,transparent,var(--bdr2),transparent);margin:36px 0}

/* Ownership tags */
.own{display:inline-flex;align-items:center;gap:4px;font-size:0.6rem;font-weight:700;padding:2px 8px;border-radius:4px;text-transform:uppercase;letter-spacing:0.06em}
.own-mp{background:var(--greeng);color:var(--green)} .own-ts{background:var(--blueg);color:var(--blue)}

/* Tags */
.tag{display:inline-block;font-family:var(--mono);font-size:0.6rem;padding:2px 6px;border-radius:4px;margin:2px;font-weight:500}
.tag-blue{background:var(--blueg);color:var(--blue);border:1px solid rgba(79,143,247,0.2)}
.tag-green{background:var(--greeng);color:var(--green);border:1px solid rgba(52,211,153,0.2)}
.tag-amber{background:var(--amberg);color:var(--amber);border:1px solid rgba(251,191,36,0.2)}
.tag-rose{background:var(--roseg);color:var(--rose);border:1px solid rgba(251,113,133,0.2)}

/* Number cards */
.num-card{text-align:center;padding:20px 16px}
.num-card .big{font-size:1.6rem;font-weight:800;font-family:var(--mono)}
.num-card .lbl{font-size:0.68rem;color:var(--txd);margin-top:6px;line-height:1.5}

/* Diagrams */
.diagram-wrap{position:relative;overflow-x:auto;overflow-y:visible;padding:12px 0;margin:20px 0}
.diagram-wrap svg{display:block;margin:0 auto;max-width:100%}
svg text{font-family:'DM Sans',sans-serif} svg .mono{font-family:'IBM Plex Mono',monospace}

/* Flow navigation */
.flow-nav{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-bottom:16px}
.flow-btn{background:var(--bg3);border:1px solid var(--bdr);color:var(--txd);padding:6px 14px;border-radius:7px;cursor:pointer;font-family:var(--sans);font-size:0.72rem;font-weight:600;transition:all 0.2s}
.flow-btn:hover{border-color:var(--bdr2);color:var(--tx)}
.flow-btn.active{color:#fff}
.flow-btn[data-flow="all"].active{background:var(--bg4);border-color:var(--txd)}
.flow-btn[data-flow="search"].active{background:rgba(79,143,247,0.2);border-color:var(--blue);color:var(--blue)}
.flow-btn[data-flow="catalog"].active{background:rgba(52,211,153,0.2);border-color:var(--green);color:var(--green)}
.flow-btn[data-flow="events"].active{background:rgba(251,191,36,0.2);border-color:var(--amber);color:var(--amber)}
.flow-btn[data-flow="purchase"].active{background:rgba(251,113,133,0.2);border-color:var(--rose);color:var(--rose)}
.flow-desc{text-align:center;height:72px;margin-bottom:12px;padding:10px 20px;background:var(--bg2);border:1px solid var(--bdr);border-radius:8px;font-size:0.76rem;color:var(--tx);line-height:1.6;max-width:900px;margin-left:auto;margin-right:auto;display:flex;align-items:center;justify-content:center;overflow:hidden}
.flow-desc strong{color:var(--txb)}
.flow-desc code{font-family:var(--mono);font-size:0.68rem;background:rgba(255,255,255,0.06);padding:1px 5px;border-radius:3px}
.legend{display:flex;gap:16px;justify-content:center;flex-wrap:wrap;margin-bottom:20px;padding:10px 16px;background:var(--bg2);border:1px solid var(--bdr);border-radius:8px}
.legend-item{display:flex;align-items:center;gap:5px;font-size:0.68rem;color:var(--txd)}
.legend-line{width:28px;height:3px;border-radius:2px}
.legend-dash{width:28px;height:0;border-top:2px dashed}

/* Relation rows */
.rel-row{display:flex;align-items:center;gap:8px;padding:7px 10px;border-radius:6px;margin-bottom:3px;font-size:0.74rem;transition:background 0.15s}
.rel-row:hover{background:rgba(79,143,247,0.05)}
.rel-from,.rel-to{font-family:var(--mono);font-weight:600;font-size:0.68rem;padding:3px 7px;border-radius:4px;white-space:nowrap}
.rel-from{background:var(--greeng);color:var(--green)} .rel-to{background:var(--blueg);color:var(--blue)}
.rel-arrow{color:var(--amber);font-family:var(--mono);font-weight:700;flex-shrink:0}
.rel-label{color:var(--txd);font-size:0.68rem;flex:1;text-align:center}

/* React Flow dark theme overrides */
.react-flow__background{background:var(--bg) !important}
.react-flow__minimap{background:var(--bg2) !important}
.react-flow__controls button{background:var(--bg3) !important;border-color:var(--bdr) !important;color:var(--txd) !important;fill:var(--txd) !important}
.react-flow__controls button:hover{background:var(--bg4) !important;color:var(--tx) !important;fill:var(--tx) !important}
.react-flow__controls button svg{fill:currentColor !important}
.react-flow__edge-path{cursor:default}
.react-flow__handle{opacity:0;transition:opacity 0.2s}
.react-flow__node:hover .react-flow__handle{opacity:1}
.editing .react-flow__handle{opacity:1}
.editing .react-flow__edge-path{cursor:pointer}

/* Edit toolbar */
.edit-toolbar{display:flex;gap:6px}
.edit-btn{background:var(--bg3);border:1px solid var(--bdr);color:var(--txd);padding:5px 12px;border-radius:7px;cursor:pointer;font-family:var(--sans);font-size:0.68rem;font-weight:600;transition:all 0.2s;white-space:nowrap}
.edit-btn:hover{border-color:var(--bdr2);color:var(--tx)}
.edit-btn-save{background:rgba(79,143,247,0.15);border-color:var(--blue);color:var(--blue)}
.edit-btn-save:hover{background:rgba(79,143,247,0.25)}
.edit-btn-cancel{background:rgba(251,113,133,0.1);border-color:var(--rose);color:var(--rose)}
.edit-btn-cancel:hover{background:rgba(251,113,133,0.2)}
.edit-btn-reset{background:var(--bg3);border-color:var(--bdr);color:var(--txd)}
.edit-btn-reset:hover{border-color:var(--amber);color:var(--amber)}

/* Curvature slider */
.curvature-slider{background:var(--bg3);border:1px solid var(--bdr);border-radius:8px;padding:8px 12px;min-width:200px}
.curvature-slider-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}
.curvature-slider-label{font-size:0.68rem;font-weight:600;color:var(--txd);font-family:var(--sans)}
.curvature-slider-close{background:none;border:none;color:var(--txd);font-size:1rem;cursor:pointer;padding:0 2px;line-height:1}
.curvature-slider-close:hover{color:var(--tx)}
.curvature-slider-body{display:flex;align-items:center;gap:8px}
.curvature-slider-body input[type="range"]{flex:1;accent-color:var(--blue)}
.curvature-slider-value{font-family:var(--mono);font-size:0.64rem;color:var(--txd);min-width:36px;text-align:right}
